<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>너, 운동된 거야</title>
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&family=Song+Myung&display=swap" rel="stylesheet">
    <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
            crossorigin="anonymous"></script>
  </head>

  <body>
    <div class="main" id="main">
      <img src="../img/logo.png" id="logo" />
      <h1 id="title">너, 운동된 거야</h1>
      <h3>랭킹을 확인해봅시다!</h3>
      <br>
      <div class="wrapper">
        <div class="lboard_section">
          <div class="lboard_tabs">
            <div class="tabs">
              <ul>
                <% if (level===10) { %>
                  <li data-li="today">Easy</li>
                  <li data-li="month">Normal</li>
                  <li class="active" data-li="year">Hard</li>
                <% } else if (level===8 || isNaN(level)) { %>
                  <li data-li="today">Easy</li>
                  <li class="active" data-li="month">Normal</li>
                  <li data-li="year">Hard</li>
                <% } else if (level===7) { %>
                  <li class="active" data-li="today">Easy</li>
                  <li data-li="month">Normal</li>
                  <li data-li="year">Hard</li>
                <% } %>
              </ul>
            </div>
          </div>
          <div class="lboard_wrap">
            <div class="lboard_item today" style="display: <%= level===7 ? 'block' : 'none' %>;">
              <% if (easyUsers.length > 0) { %>
                <% for (let i = 0; i < easyUsers.length; i++) { %>
                  <% user=easyUsers[i]%>
                  <% if (level === 7 && user.userName === nickname && user.score === score) { %>
                    <div class="lboard_mem" id="user_rank">
                      <p id="rank_num"> <%= i+1 %> </p>
                      <div class="img">
                        <img src="https://mblogthumb-phinf.pstatic.net/MjAxNzA1MjRfMTAz/MDAxNDk1NjE5MTE3Njcx.m8TE9hsAsYnB73tWkYKqMLWuDdiMn33Krn2dZEV8RFkg.yS8UzBDdAZO2tr6swZJF-SRKo46sFZ2btqoppLbvstUg.PNG.hanee218/025Pikachu_OS_anime_11.png?type=w800" alt="picture_1">
                      </div>
                      <p id="rank_name"> <%= user.userName %> </p>

                      <div class="rank_bar">
                        <div class="bar_wrap">
                          <div class="inner_bar" style="width: <%= (100*user.score)/easyUsers[easyUsers.length-1].score %>%"></div>
                        </div>
                      </div>
                      <div class="points">
                        <%= user.score %> points
                      </div>
                      <div class="date">
                        <%= String(user.date).slice(4, 15) %>
                      </div>
                    </div>
                  <% } else { %>
                    <div class="lboard_mem">
                      <p id="rank_num"> <%= i+1 %> </p>
                      <div class="img">
                        <img src="https://mblogthumb-phinf.pstatic.net/MjAxNzA1MjRfMTAz/MDAxNDk1NjE5MTE3Njcx.m8TE9hsAsYnB73tWkYKqMLWuDdiMn33Krn2dZEV8RFkg.yS8UzBDdAZO2tr6swZJF-SRKo46sFZ2btqoppLbvstUg.PNG.hanee218/025Pikachu_OS_anime_11.png?type=w800" alt="picture_1">
                      </div>
                      <p id="rank_name"> <%= user.userName %> </p>

                      <div class="rank_bar">
                        <div class="bar_wrap">
                          <div class="inner_bar" style="width: <%= (100*user.score)/easyUsers[easyUsers.length-1].score %>%"></div>
                        </div>
                      </div>
                      <div class="points">
                        <%= user.score %> points
                      </div>
                      <div class="date">
                        <%= String(user.date).slice(4, 15) %>
                      </div>
                    </div>
                  <% } %>
                <% } %>
              <% } else { %>
                  <h1>아직 플레이한 유저가 없습니다!</h1>
              <% } %>
            </div>
            <div class="lboard_item month" style="display: <% level===8 || level===null ? 'block' : 'none' %>;">
              <% if (normalUsers.length > 0) { %>
                <% for (let i = 0; i < normalUsers.length; i++) { %>
                <% user=normalUsers[i]%>
                  <% if (level === 8 && user.userName === nickname && user.score === score) { %>
                    <div class="lboard_mem" id="user_rank">
                      <p id="rank_num"> <%= i+1 %> </p>
                      <div class="img">
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTOEwtRoO1z9zsnFi98g9vjjQSUwtm2ZKvbig&usqp=CAU" alt="picture_2">
                      </div>
                      <p id="rank_name"> <%= user.userName %> </p>

                      <div class="rank_bar">
                        <div class="bar_wrap">
                          <div class="inner_bar" style="width: <%= (100*user.score)/normalUsers[normalUsers.length-1].score %>%"></div>
                        </div>
                      </div>
                      <div class="points">
                        <%= user.score %> points
                      </div>
                      <div class="date">
                        <%= String(user.date).slice(4, 15) %>
                      </div>
                    </div>
                  <% } else { %>
                    <div class="lboard_mem">
                      <p id="rank_num"> <%= i+1 %> </p>
                      <div class="img">
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTOEwtRoO1z9zsnFi98g9vjjQSUwtm2ZKvbig&usqp=CAU" alt="picture_2">
                      </div>
                      <p id="rank_name"> <%= user.userName %> </p>

                      <div class="rank_bar">
                        <div class="bar_wrap">
                          <div class="inner_bar" style="width: <%= (100*user.score)/normalUsers[normalUsers.length-1].score %>%"></div>
                        </div>
                      </div>
                      <div class="points">
                        <%= user.score %> points
                      </div>
                      <div class="date">
                        <%= String(user.date).slice(4, 15) %>
                      </div>
                    </div>
                  <% } %>
                <% } %>
              <% } else { %>
                  <h1>아직 플레이한 유저가 없습니다!</h1>
              <% } %>
            </div>
            <div class="lboard_item year" style="display: <% level===10 ? 'block' : 'none' %>;">
            
              <% if (hardUsers.length > 0) { %>
                <% for (let i=0;i<hardUsers.length;i++) { %>
                  <% user=hardUsers[i]%>
                  <% if (level === 10 && user.userName === nickname && user.score === score) { %>
                    <div class="lboard_mem" id="user_rank">
                      <p id="rank_num"> <%= i+1 %> </p>
                      <div class="img">
                        <img src="https://item.kakaocdn.net/do/42993278d627d0139cd208cb73151c548f324a0b9c48f77dbce3a43bd11ce785" alt="picture_5">
                      </div>
                      <p id="rank_name"> <%= user.userName %> </p>

                      <div class="rank_bar">
                        <div class="bar_wrap">
                          <div class="inner_bar" style="width: <%= (100*user.score)/hardUsers[hardUsers.length-1].score %>%"></div>
                        </div>
                      </div>
                      <div class="points">
                        <%= user.score %> points
                      </div>
                      <div class="date">
                        <%= String(user.date).slice(4, 15) %>
                      </div>
                    </div>
                  <% } else { %>
                    <div class="lboard_mem">
                      <p id="rank_num"> <%= i+1 %> </p>
                      <div class="img">
                        <img src="https://item.kakaocdn.net/do/42993278d627d0139cd208cb73151c548f324a0b9c48f77dbce3a43bd11ce785" alt="picture_5">
                      </div>
                      <p id="rank_name"> <%= user.userName %> </p>

                      <div class="rank_bar">
                        <div class="bar_wrap">
                          <div class="inner_bar" style="width: <%= (100*user.score)/hardUsers[hardUsers.length-1].score %>%"></div>
                        </div>
                      </div>
                      <div class="points">
                        <%= user.score %> points
                      </div>
                      <div class="date">
                        <%= String(user.date).slice(4, 15) %>
                      </div>
                    </div>
                  <% } %>
                  <% } %>
                  <% } else { %>
                    <h1>아직 플레이한 유저가 없습니다!</h1>
                  <% } %>
              </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      var tabs = document.querySelectorAll(".lboard_tabs ul li");
      var today = document.querySelector(".today");
      var month = document.querySelector(".month");
      var year = document.querySelector(".year");
      var items = document.querySelectorAll(".lboard_item");

      tabs.forEach(function(tab){
        tab.addEventListener("click", function(){
          var currenttab = tab.getAttribute("data-li");

          tabs.forEach(function(tab){
            tab.classList.remove("active");
          })

          tab.classList.add("active");

          items.forEach(function(item){
            item.style.display = "none";
          })

          if(currenttab == "today"){
            today.style.display = "block";
          }
          else if(currenttab == "month"){
            month.style.display = "block";
          }
          else{
            year.style.display = "block";
          }
        })
      })
    </script>
  </body>
</html>
